<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scGTM">
<title>Real Data Analysis Example 1 • scGTM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Real Data Analysis Example 1">
<meta property="og:description" content="scGTM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scGTM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/RealDataAnalysis1.html">Real Data Analysis Example 1</a>
    <a class="dropdown-item" href="../articles/RealDataAnalysis2.html">Real Data Analysis Example 2</a>
    <a class="dropdown-item" href="../articles/vignette.html">scGTM Quickstart</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Sylviama1026/scGTM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Real Data Analysis Example 1</h1>
                        <h4 data-toc-skip class="author">Dongyuan Song</h4>
            <address class="author_afil">
      Bioinformatics IDP, University of California, Los Angeles<br><a class="author_email" href="mailto:#"></a><a href="mailto:dongyuansong@ucla.edu" class="email">dongyuansong@ucla.edu</a>
      </address>
                              <h4 data-toc-skip class="author">Lehan Zou</h4>
            <address class="author_afil">
      Dertment of Statistics, University of California, Los Angeles<br><a class="author_email" href="mailto:#"></a><a href="mailto:lehanz77@g.ucla.edu" class="email">lehanz77@g.ucla.edu</a>
      </address>
                              <h4 data-toc-skip class="author">Shiyu Ma</h4>
            <address class="author_afil">
      Department of Statistics, University of California, Los Angeles<br><a class="author_email" href="mailto:#"></a><a href="mailto:sylviama1026@g.ucla.edu" class="email">sylviama1026@g.ucla.edu</a>
      </address>
                  
      
      <small class="dont-index">Source: <a href="https://github.com/Sylviama1026/scGTM/blob/HEAD/vignettes/RealDataAnalysis1.Rmd" class="external-link"><code>vignettes/RealDataAnalysis1.Rmd</code></a></small>
      <div class="d-none name"><code>RealDataAnalysis1.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="real-data-analysis-example-1">Real Data Analysis Example 1<a class="anchor" aria-label="anchor" href="#real-data-analysis-example-1"></a>
</h2>
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>In this example, we will show scGTM recapitulates gene expression trends of endometrial transformation in the human menstrual cycle.This is originally from the second example the author showed in part 3 of the scGTM paper.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SingleCellExperiment</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap" class="external-link">ComplexHeatmap</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jaredlander/useful" class="external-link">useful</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mikelove/DESeq2" class="external-link">DESeq2</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Sylviama1026/scGTM" class="external-link">scGTM</a></span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="read-the-reference-data">Read the Reference Data<a class="anchor" aria-label="anchor" href="#read-the-reference-data"></a>
</h3>
<p>This WANG dataset contains 20 exemplar genes that exhibit temporal expression trends in unciliated epithelia cells in the human menstrual cycle.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wang_sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"wang_sce.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PLAU"</span>, <span class="st">"MMP7"</span>, <span class="st">"THBS1"</span>, <span class="st">"CADM1"</span>, <span class="st">"NPAS3"</span>, <span class="st">"ATP1A1"</span>, <span class="st">"ANK3"</span>, <span class="st">"ALPL"</span>, <span class="st">"TRAK1"</span>, <span class="st">"SCGB1D2"</span>, <span class="st">"MT1F"</span>, <span class="st">"MT1X"</span>, <span class="st">"MT1E"</span>, <span class="st">"MT1G"</span>, <span class="st">"CXCL14"</span>, <span class="st">"MAOA"</span>, <span class="st">"DPP4"</span>, <span class="st">"NUPR1"</span>, <span class="st">"GPX3"</span>, <span class="st">"PAEP"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">GSE111976_summary_C1_donor_phase</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="st">"GSE111976_summary_C1_donor_phase.csv"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## New names:</span></span>
<span><span class="co">## <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">19</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">4</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span></span></span>
<span><span class="co">## <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span> <span style="font-weight: bold;">Delimiter:</span> "," <span style="color: #BB0000;">chr</span></span></span>
<span><span class="co">## (1): phase_canonical <span style="color: #00BB00;">dbl</span> (3): ...1, donor, phase_sc_Fig.3</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data. <span style="color: #00BBBB;">ℹ</span></span></span>
<span><span class="co">## Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">•</span> `` -&gt; `...1`</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sce</span><span class="op">)</span><span class="op">$</span><span class="va">phase_canonical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sce</span><span class="op">)</span><span class="op">$</span><span class="va">donor</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="va">GSE111976_summary_C1_donor_phase</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">donor</span> <span class="op">==</span> <span class="va">x</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">phase_canonical</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sce</span><span class="op">)</span><span class="op">$</span><span class="va">phase_canonical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sce</span><span class="op">)</span><span class="op">$</span><span class="va">phase_canonical</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"menstrual"</span>, <span class="st">"proliferative_early"</span>,<span class="st">"proliferative_late"</span>, <span class="st">"secretory_early"</span>,<span class="st">"secretory_mid"</span>, <span class="st">"secretory_late"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wang_sub</span> <span class="op">&lt;-</span> <span class="va">wang_sce</span><span class="op">[</span><span class="va">gene_vec</span>, <span class="op">]</span></span>
<span><span class="va">cell_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/pkg/tibble/man/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pseudotime</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">cell</span></span>
<span><span class="va">pseudotime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/pkg/tibble/man/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pseudotime</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">pseudotime</span></span>
<span><span class="va">wang_sub</span> <span class="op">&lt;-</span> <span class="va">wang_sub</span><span class="op">[</span><span class="va">gene_vec</span>, <span class="va">cell_order</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log1p</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">wang_sub</span>, <span class="st">"cpm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cell_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/tibble/man/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pseudotime</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">cell</span></span>
<span><span class="va">pseudotime</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/tibble/man/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span>rownames <span class="op">=</span> <span class="st">"cell"</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">pseudotime</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">.</span><span class="op">$</span><span class="va">pseudotime</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span>, <span class="va">cell_order</span><span class="op">]</span></span>
<span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mat</span>, <span class="fl">1</span>, <span class="va">rescale</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Find color which is appropriate</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ha</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">HeatmapAnnotation</a></span><span class="op">(</span>Phase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span><span class="op">$</span><span class="va">phase_canonical</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Phase <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"menstrual"</span> <span class="op">=</span> <span class="st">"#A50026"</span>, <span class="st">"proliferative_early"</span> <span class="op">=</span> <span class="st">"#D73027"</span>,<span class="st">"proliferative_late"</span> <span class="op">=</span> <span class="st">"#FEE090"</span>, <span class="st">"secretory_early"</span> <span class="op">=</span> <span class="st">"#ABD9E9"</span>,<span class="st">"secretory_mid"</span> <span class="op">=</span> <span class="st">"#4575B4"</span>, <span class="st">"secretory_late"</span> <span class="op">=</span> <span class="st">"#313695"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">mat</span>, cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, show_column_names <span class="op">=</span> <span class="cn">FALSE</span>, col<span class="op">=</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, top_annotation <span class="op">=</span> <span class="va">ha</span>, name <span class="op">=</span> <span class="st">"heatmap1"</span>, show_heatmap_legend <span class="op">=</span> <span class="cn">FALSE</span>, column_title <span class="op">=</span> <span class="st">"Original Data"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, pseudotime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span><span class="op">$</span><span class="va">pseudotime</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">wang_sub</span>, <span class="st">"cpm"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="import-parameter-csv">Import parameter csv<a class="anchor" aria-label="anchor" href="#import-parameter-csv"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Poisson_para</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/runscGTM.html">runscGTM</a></span><span class="op">(</span>t<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">wang_sub</span><span class="op">)</span>, y<span class="op">=</span><span class="va">wang_sub</span>, sce<span class="op">=</span><span class="st">"counts"</span>, marginal<span class="op">=</span><span class="st">"Poisson"</span>,hill_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene MT1F with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.65 2.06 30.48 0.73 6.57 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.709 ,  0.744 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 1.827 ,  2.29 )</span></span>
<span><span class="co">##  k2 : ( 22.364 ,  38.588 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene MT1X with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.29 2.12 16.1 0.67 -35.3 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.648 ,  0.697 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 1.812 ,  2.42 )</span></span>
<span><span class="co">##  k2 : ( 11.476 ,  20.721 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene MT1E with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.06 3.23 7.19 0.64 -15.87 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.601 ,  0.67 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 2.687 ,  3.783 )</span></span>
<span><span class="co">##  k2 : ( 4.591 ,  9.78 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene MT1G with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.43 3.51 47.7 0.73 -66.68 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.719 ,  0.743 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 3.24 ,  3.779 )</span></span>
<span><span class="co">##  k2 : ( 37.784 ,  57.612 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene CXCL14 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  6.18 54.42 53.49 0.77 70.46 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.761 ,  0.78 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 47.075 ,  61.763 )</span></span>
<span><span class="co">##  k2 : ( 42.879 ,  64.107 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene MAOA with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.85 99 64.44 0.78 17.44 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.769 ,  0.785 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 82.13 ,  115.87 )</span></span>
<span><span class="co">##  k2 : ( 51.934 ,  76.939 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene DPP4 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.14 72.66 35.52 0.77 6.25 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.759 ,  0.782 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 59.639 ,  85.673 )</span></span>
<span><span class="co">##  k2 : ( 27.194 ,  43.847 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene NUPR1 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.71 25.11 23.22 0.79 -47.81 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.773 ,  0.801 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 21.787 ,  28.424 )</span></span>
<span><span class="co">##  k2 : ( 16.45 ,  29.999 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene GPX3 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  8.23 -40.03 9.39 0.72 47.85 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.72 ,  0.725 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( -41.167 ,  -38.895 )</span></span>
<span><span class="co">##  k2 : ( 8.321 ,  10.463 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene PAEP with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  9.27 51.74 34.21 0.79 13.8 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.787 ,  0.8 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 46.892 ,  56.595 )</span></span>
<span><span class="co">##  k2 : ( 28.621 ,  39.794 )</span></span></code></pre>
<pre><code><span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene PLAU with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.41 86.22 34.32 0.15 4 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.144 ,  0.162 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 63.3 ,  109.138 )</span></span>
<span><span class="co">##  k2 : ( 30.292 ,  38.352 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene MMP7 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.67 2.42 17.73 0.21 19.38 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.187 ,  0.224 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( -0.344 ,  5.186 )</span></span>
<span><span class="co">##  k2 : ( 15.247 ,  20.213 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene THBS1 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.54 13.1 17.84 0.21 -99 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.198 ,  0.229 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 8.71 ,  17.481 )</span></span>
<span><span class="co">##  k2 : ( 15.589 ,  20.094 )</span></span>
<span><span class="co">## The need of transformation:  TRUE</span></span>
<span><span class="co">## We are estimating gene CADM1 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  5.05 10.43 16.4 0.24 -1.65 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.221 ,  0.255 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 6.942 ,  13.926 )</span></span>
<span><span class="co">##  k2 : ( 14.09 ,  18.707 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene NPAS3 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.27 30.29 15.57 0.29 0.34 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.274 ,  0.3 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 24.274 ,  36.298 )</span></span>
<span><span class="co">##  k2 : ( 13.536 ,  17.602 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene ATP1A1 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.59 4.76 5.09 0.44 39.01 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.408 ,  0.465 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 3.605 ,  5.906 )</span></span>
<span><span class="co">##  k2 : ( 4.226 ,  5.96 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene ANK3 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.86 6.04 13.54 0.48 7.51 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.467 ,  0.501 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 5.175 ,  6.908 )</span></span>
<span><span class="co">##  k2 : ( 11.71 ,  15.374 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene ALPL with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.41 11.12 23.4 0.44 41.75 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.43 ,  0.458 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 9.564 ,  12.685 )</span></span>
<span><span class="co">##  k2 : ( 19.772 ,  27.018 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene TRAK1 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  4.42 6.95 19.41 0.49 48.79 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.477 ,  0.509 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 6.017 ,  7.887 )</span></span>
<span><span class="co">##  k2 : ( 16.6 ,  22.214 )</span></span>
<span><span class="co">## The need of transformation:  FALSE</span></span>
<span><span class="co">## We are estimating gene SCGB1D2 with marginal Poisson .</span></span>
<span><span class="co">## Best parameter estimation:</span></span>
<span><span class="co">##  mu , k1 , k2 , t0:</span></span>
<span><span class="co">##  6.53 5.25 38.29 0.61 23.09 </span></span>
<span><span class="co">## The 95% confidence interval of the activation time t0:</span></span>
<span><span class="co">##  t0 : ( 0.602 ,  0.627 )</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## The 95% CIs for activation strength k1 and k2:</span></span>
<span><span class="co">##  k1 : ( 4.839 ,  5.66 )</span></span>
<span><span class="co">##  k2 : ( 32.149 ,  44.439 )</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Poisson_para</span><span class="op">$</span><span class="va">maxy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">wang_sub</span>,<span class="st">'counts'</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span>,<span class="va">max</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Poisson_para</span> <span class="op">&lt;-</span> <span class="va">Poisson_para</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gene'</span>,<span class="st">'mu'</span>,<span class="st">'k1'</span>,<span class="st">'k2'</span>,<span class="st">'t0'</span>,<span class="st">'Transform'</span>,<span class="st">'maxy'</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="gene-curve-function">Gene curve function<a class="anchor" aria-label="anchor" href="#gene-curve-function"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_curve</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">mu</span>, <span class="va">k1</span>, <span class="va">k2</span>, <span class="va">t0</span>, <span class="va">flag</span>, <span class="va">maxy</span>, <span class="va">hill_only</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">link</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">mu</span>, <span class="va">k1</span>, <span class="va">k2</span>, <span class="va">t0</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">part1</span><span class="op">&lt;-</span><span class="va">mu</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">k1</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">t0</span><span class="op">)</span> <span class="op">**</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">k1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">k1</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">part2</span><span class="op">&lt;-</span><span class="va">mu</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">k2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="va">t0</span><span class="op">)</span> <span class="op">**</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html" class="external-link">sign</a></span><span class="op">(</span><span class="va">k2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">k2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">out</span><span class="op">&lt;-</span><span class="va">part1</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">&lt;=</span> <span class="va">t0</span><span class="op">)</span> <span class="op">+</span> <span class="va">part2</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">&gt;</span> <span class="va">t0</span><span class="op">)</span></span>
<span>  <span class="va">out</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="va">log_mut_fit</span> <span class="op">&lt;-</span> <span class="fu">link</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>, <span class="va">mu</span>, <span class="va">k1</span>, <span class="va">k2</span>, <span class="va">t0</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">hill_only</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co">#transformation if valley</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">flag</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">log_mut_fit</span> <span class="op">=</span> <span class="op">-</span><span class="va">log_mut_fit</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">maxy</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">}</span></span>
<span>  <span class="va">log_mut_fit</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="poisson">Poisson<a class="anchor" aria-label="anchor" href="#poisson"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">Poisson_para</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">t_vec</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">t_vec</span>, <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">v</span> <span class="op">&lt;-</span> <span class="fu">gene_curve</span><span class="op">(</span>t <span class="op">=</span> <span class="va">t</span>, mu <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, k1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>, k2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                    t0 <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, flag<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, maxy<span class="op">=</span><span class="va">x</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>, hill_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">v</span><span class="op">}</span><span class="op">)</span></span>
<span>  <span class="op">}</span>, t_vec <span class="op">=</span> <span class="va">pseudotime</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">1</span>, <span class="va">rescale</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">Heatmap</a></span><span class="op">(</span><span class="va">res</span>, cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>, cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>, show_column_names <span class="op">=</span> <span class="cn">FALSE</span>, col<span class="op">=</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span>, top_annotation <span class="op">=</span> <span class="va">ha</span>, name <span class="op">=</span> <span class="st">"Normalized logCPM"</span>, show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>, column_title <span class="op">=</span> <span class="st">"Fitted scGTMs"</span><span class="op">)</span></span></code></pre></div>
<p>Pseudotime quantile</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Fn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">pseudotime</span><span class="op">)</span></span>
<span><span class="va">pos</span> <span class="op">&lt;-</span> <span class="fu">Fn</span><span class="op">(</span><span class="va">Poisson_para</span><span class="op">$</span><span class="va">t0</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht_list</span> <span class="op">&lt;-</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">ht_list</span>, merge_legend <span class="op">=</span> <span class="cn">TRUE</span>, ht_gap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">"in"</span><span class="op">)</span>, auto_adjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/decorate_heatmap_body.html" class="external-link">decorate_heatmap_body</a></span><span class="op">(</span><span class="st">"Normalized logCPM"</span>, <span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/grid/grid.lines.html" class="external-link">grid.lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pos</span><span class="op">[</span><span class="fl">21</span><span class="op">-</span><span class="va">i</span><span class="op">]</span>, <span class="va">pos</span><span class="op">[</span><span class="fl">21</span><span class="op">-</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">20</span>, <span class="va">i</span><span class="op">/</span><span class="fl">20</span><span class="op">)</span>, gp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> </span>
<span><span class="op">}</span>, slice <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="RealDataAnalysis1_files/figure-html/unnamed-chunk-16-1.png" width="1152"> The original study ordered the 20 genes by the estimated pseudotime at which they achieved the maximum expression. The second plot shows that the data agreed well with the menstrual cycle phases using scGTM, with the red segments highlighting the estimated change times <span class="math inline">\(t_0\)</span>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Shiyu Ma, Lehan Zou.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
